# مدیریت پراکسی سینگ باکس
### تغییرات جدید: 
- دیگه نیاز نیست زمان تجدید کانفیگ رو به ثانیه وارد کنید، به ساعت وارد کنید اینجا تبدیل میشه
- در کانال نسخه base64 کانفیگ ارسال میشه و نسخه خام فقط برای خودتون ارسال میشه، اگه دیدید فرق دارن نگران نباشید هر دو کار میکنه

### قابلیت های بات:
- اضافه کردن کانفیگ ها در دامنه ای که به سرورتون وصل شده (و با چیزی مثل nginx راه اندازی شده) بعنوان لینک سابسکریپشن
- قابلیت ویرایش اطلاعات اولیه(user_data) از جمله آیدی کانال تلگرام و توکن بات و...
- کارای راه اندازی از جمله ویرایش کانفیگ و فعال کردن سرویس رو خودش انجام میده
- قابلیت تعریف کانال و ارسال کانفیگ ها به کانال تلگرامی
- خودش در بازه های زمانی که براش تعریف کردید uuid، key_pair و short_id رو تجدید میکنه و کانفیگ جدید رو تو بات میفرسته
- با دستور status میتونید استاتوس هر سرویسی از جمله سینگ باکس یا بات رو بگیرید
- با دستور start (برای اولین بار) یوزر شما بعنوان صاحب بات ثبت میشه و دیگه فقط به پیام های شما جواب میده
- دفعات بعد که دستور start رو بفرستید میتونید به صورت دستی uuid و... سینگ باکس رو تغییر بدید و کانفیگ جدید رو براتون میفرسته 
- کسی غیر از خودتون به بات پیام start بده آخرین کانفیگ رو براش میفرسته

 

#### از طریق آموزش سگارو از لینک زیر نحوه پیدا کردن SNI خوب و ساز و کار کلی کارکرد سیستم رو یاد بگیرید، من خودم از اونجا یاد گرفتم

[آموزش سگارو](https://telegra.ph/How-run-Reality-protocol-with-Xray-or-Sing-box-Core-with-iSegaro-04-18)

## راه اندازی بات
اگه قبلا نسخه ای دیگه از این بات رو نصب کردید ابتدا با دستور های زیر قبلی ها رو پاک کنید:
```bash
curl -Lo /root/cleaner.py https://raw.githubusercontent.com/HoMa431/sb-server-configer/master/cleaner.py
python3 cleaner.py
```
اول فایل first.py رو میگیریم که آی پی و پورت سرورتون و توکن بات تلگرام رو به راحتی ست کنید و بقیه کار رو هم خودش خودکار انجام میده شما نیازی نیست کاری انجام بدید.
```bash
mkdir configer && cd configer
curl -Lo /root/configer/first.py https://raw.githubusercontent.com/HoMa431/sb-server-configer/master/first.py
```
حالا بریم سراغ اجرا کردن اسکریپت. اول ازتون میپرسه میخواید به کانال وصل بشه یا به خودتون پیام بده، اگر میخواید به کانال وصل شه تایپ کنید ch و اگه برای خودتون me . بعدش به ترتیب آی پی، پورت سرور، آی دی کانال تلگرام که باید از بات myidbot بگیرید، بعدش توکن بات تلگرام تون و در نهایت بازه زمانی ای که میخواید خودکار کانفیگ سینگ باکس رو تغییر بده به ساعت(یعنی برای روزی یه بار میشه 24). دستور زیر رو اجرا کنید:
```bash
python3 first.py
```
اگر بعدا خواستید اطلاعات اولیه ای که ست کردید رو تغییر بدید نیاز نیست کل پروسه رو از اول انجام بدید، دستور زیر رو اجرا کنید:
```bash
python3 user_data_editor.py
```
بعد از اینکه تموم شد دستور زیر رو اجرا کنید که فایل first.py که دیگه بهش احتیاج نداریم حذف بشه:
```bash
rm first.py
```

اسکریپت مون که اجرا شد خودش براتون کانفیگ اولیه رو ست میکنه و قبل از هر چیزی دستور start/ رو براش بفرستید. شما با ارسال دستور start/ در تلگرام به بات تون هم کانفیگ رو دریافت میکنید هم آی دی شما بعنوان صاحب ست میشه و دیگه بات فقط به شما جواب میده. 
در نظر داشته باشید برای اینکه بات بتونه تو کانالی که براش تعریف کردید پیام بده باید اونجا ادمین شده باشه!

اگر بعد از اینکه پراکسی رو راه انداحتید کانفیگ تون تایم اوت داد اس ان آی  جدید براش بفرستید تو تلگرام و دوباره امتحان کنید. پیامی که به بات تلگرام میفرستید هم به این شکل باشه
```bash
/replace sni
```
با دستور status/ هم میتونید استاتوس سینگ باکس یا کانفیگر رو تو تلگرام دریافت کنید که ببینید سینگ باکس در چه وضعیتیه و اگه مشکلی هست از کجاست.
```bash
/status sing-box
/status configer.service
```
با دستور run/ هم میتونید هر دستوری که خواستید تو ترمینال اجرا کنید و نتیجه ش براتون ارسال میشه
```bash
/run command
```
بعنوان مثال دو تا دستور پر کاربرد برای چک کردن پورت ها و ریستارت کردن سرور:
```bash
/run netstat -tulnp
/run reboot
```


*با تشکر از همه کسایی که برای دسترسی آزاد به اینترنت زحمت میکشن از جمله سگارو عزیز و تیم IRCF*
